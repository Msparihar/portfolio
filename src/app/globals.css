@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;
    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground font-mono;
    font-family: var(--font-ibm-plex-mono), var(--font-fira-code), monospace;
    /* Optimize font rendering and prevent layout shifts */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    font-synthesis: none;
    /* Prevent font-related layout shifts during loading */
    visibility: visible;
  }

  /* Optimize image rendering */
  img {
    content-visibility: auto;
    /* Reduce layout shifts */
    aspect-ratio: attr(width) / attr(height);
  }

  /* Critical CSS for terminal - Enhanced containment */
  .terminal-container {
    contain: layout style paint;
    content-visibility: auto;
  }

  /* Optimize all interactive elements */
  a, button {
    contain: layout style;
  }

  /* Optimize grid layouts */
  [class*="grid"] {
    contain: layout style;
  }

  /* Input field stabilization to prevent shifts */
  input {
    contain: layout style;
  }

  /* TypeWriter component containment */
  .typing-animation,
  [class*="TypeWriter"] {
    contain: layout;
  }
}

@layer components {
  .terminal-container {
    @apply p-4 md:p-6 rounded-lg shadow-lg;
    /* Optimize repaints */
    will-change: auto;
  }

  /* Dark mode terminal styling */
  .dark .terminal-container {
    @apply text-green-500;
    background-color: rgba(0, 0, 0, 0.95);
    box-shadow: 0 0 30px rgba(0, 255, 0, 0.05);
  }

  /* Light mode terminal styling */
  .terminal-container:not(.dark *) {
    @apply text-green-800;
    background-color: rgba(255, 255, 255, 0.95);
    box-shadow: 0 0 30px rgba(0, 100, 0, 0.08);
  }

  .terminal-nav {
    @apply backdrop-blur-sm border-border/30;
    background: transparent;
    contain: layout style;
  }

  .terminal-nav button {
    @apply text-sm transition-all duration-200 ease-in-out;
    min-width: fit-content;
  }

  .terminal-nav button:hover {
    @apply transform scale-105;
  }

  .command-prompt {
    @apply text-green-500/80 dark:text-green-500/80;
  }

  /* Light mode command prompt */
  :not(.dark) .command-prompt {
    @apply text-green-700/90;
  }

  .terminal-link {
    @apply text-blue-400 hover:text-blue-300 underline-offset-4 hover:underline transition-colors;
  }

  .typing-animation {
    display: inline-block;
    overflow: hidden;
    border-right: 2px solid;
    white-space: normal;
    animation: typing 2s steps(40, end), blink-caret 0.75s step-end infinite;
    width: fit-content;
    max-width: 100%;
  }

  @keyframes typing {
    from {
      width: 0;
    }
    to {
      width: 100%;
    }
  }

  @keyframes blink-caret {
    from,
    to {
      border-color: transparent;
    }
    50% {
      border-color: currentColor;
    }
  }

  .terminal-line {
    line-height: 1.6;
  }

  .highlighted-text {
    @apply text-yellow-500 font-semibold px-1 py-0.5 bg-yellow-500/10 rounded;
  }

  .terminal-title {
    @apply flex items-center gap-2;
  }

  .terminal-title::after {
    content: '';
    @apply flex-grow h-[1px] bg-border/30;
  }

  /* GitHub contributions specific optimizations - Enhanced containment */
  .github-contributions-container {
    contain: layout style paint;
    content-visibility: auto;
  }

  /* GitHub calendar grid stabilization */
  .github-calendar {
    contain: layout size;
    /* Prevent any layout shifts from the calendar grid */
  }

  /* Optimize grid backgrounds */
  .bg-dot-white\/\[0\.2\],
  .bg-dot-black\/\[0\.2\] {
    background-size: 30px 30px;
    background-position: center;
    will-change: auto;
  }

  /* Optimize radial gradients */
  .bg-gradient-radial {
    background-image: radial-gradient(circle at center, var(--tw-gradient-stops));
    will-change: auto;
  }
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Loading skeleton animations */
@keyframes skeleton-loading {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.skeleton {
  background: linear-gradient(
    90deg,
    transparent,
    rgba(255, 255, 255, 0.05),
    transparent
  );
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
}